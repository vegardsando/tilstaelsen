var viewSpecificOptions={week:{titleFormat:"MMMM D, YYYY",columnFormat:"ddd D",timeFormat:"LT",slotLabelFormat:"LT"},day:{titleFormat:"dddd, MMMM D, YYYY",columnFormat:"",timeFormat:"LT",slotLabelFormat:"LT"}},selectedCalendarsStorageKey="calendar-selectedCalendars",qTipsEnabled=!0,$calendar=$("#solspace-calendar"),$miniCal=$("#calendar-mini-cal");$(function(){"use strict";var e=new moment;"undefined"!=typeof calendarCurrentDay&&(e=new moment(calendarCurrentDay)),$calendar.fullCalendar({defaultDate:e,defaultView:$calendar.data("view"),nextDayThreshold:"0"+calendarOverlapThreshold+":00:01",fixedWeekCount:!0,eventLimit:5,aspectRatio:1.3,editable:canEditEvents,lang:calendarLocale,views:viewSpecificOptions,firstDay:calendarFirstDayOfWeek,viewRender:renderView,events:getEvents,eventRender:renderEvent,dayRender:renderDay,eventDragStart:closeAllQTips,eventDragStop:enableQTips,eventDrop:eventDateChange,eventResizeStart:closeAllQTips,eventResizeStop:enableQTips,eventResize:eventDurationChange,selectable:canEditEvents,selectHelper:canEditEvents,select:showEventCreator,unselectAuto:!1,customButtons:{refresh:{text:Craft.t("calendar_refresh"),click:function(){$calendar.fullCalendar("refetchEvents")}}},header:{right:"refresh prev,today,next",left:"title"}}),"month"!==$calendar.fullCalendar("getView").name&&$calendar.fullCalendar("option","height","auto"),$(".fc-next-button, .fc-prev-button, .fc-today-button",$calendar).on({click:function(){var e=$calendar.fullCalendar("getView").type,a=$calendar.fullCalendar("getDate"),t=a.format("YYYY"),n=a.format("MM"),l=a.format("DD"),r="month";switch(e){case"agendaDay":r="day";break;case"agendaWeek":r="week"}var d=Craft.getCpUrl("calendar/view/"+r+"/"+t+"/"+n+"/"+l);history.pushState("data","",d)}}),$(".alert-dismissible a.close").on({click:function(){var e=$(this).parents(".alert:first");Craft.postActionRequest("calendar/view/dismissDemoAlert",{},function(a){e.remove()})}}),$(".calendar-list input").on({change:function(){var e=$("ul.calendar-list input:checked").map(function(){return $(this).val()}).get().join();localStorage.setItem(selectedCalendarsStorageKey,e),$miniCal.data("calendars",e),$miniCal.fullCalendar("refetchEvents"),$calendar.fullCalendar("refetchEvents")}});var a=$("#event-creator"),t=$(".lightswitch",a);t.on({change:function(){var e=$(".timewrapper",a);$("input",this).val()?e.fadeOut("fast"):e.fadeIn("fast")}})});var selectedCalendars=localStorage.getItem(selectedCalendarsStorageKey);null!=selectedCalendars&&($miniCal.data("calendars",selectedCalendars),$miniCal.fullCalendar("refetchEvents"),selectedCalendars=selectedCalendars.split(","),$(".calendar-list input").each(function(){var e=-1!==selectedCalendars.indexOf($(this).val());$(this).prop("checked",e)}));